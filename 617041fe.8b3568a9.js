(window.webpackJsonp=window.webpackJsonp||[]).push([[7],{65:function(e,t,n){"use strict";n.r(t),n.d(t,"frontMatter",(function(){return l})),n.d(t,"metadata",(function(){return s})),n.d(t,"rightToc",(function(){return u})),n.d(t,"default",(function(){return b}));var a=n(2),r=n(6),o=(n(0),n(75)),i=n(86),c=n(87),l={title:"Setup & requirements"},s={unversionedId:"setup",id:"setup",isDocsHomePage:!1,title:"Setup & requirements",description:"Package structure",source:"@site/docs/setup.mdx",slug:"/setup",permalink:"/docs/setup",editUrl:"https://github.com/milesj/packemon/edit/master/website/docs/setup.mdx",version:"current",sidebar:"docs",previous:{title:"Installation",permalink:"/docs/install"},next:{title:"Package configuration",permalink:"/docs/config"}},u=[{value:"Package structure",id:"package-structure",children:[]},{value:"TypeScript integration",id:"typescript-integration",children:[{value:"Update output directories",id:"update-output-directories",children:[]},{value:"Enable emitting",id:"enable-emitting",children:[]},{value:"Disable JSON resolving",id:"disable-json-resolving",children:[]},{value:"Supporting project references",id:"supporting-project-references",children:[]}]}],p={rightToc:u};function b(e){var t=e.components,n=Object(r.a)(e,["components"]);return Object(o.b)("wrapper",Object(a.a)({},p,n,{components:t,mdxType:"MDXLayout"}),Object(o.b)("h2",{id:"package-structure"},"Package structure"),Object(o.b)("p",null,"Whether a solorepo (1 package) or a monorepo (many packages), Packemon makes the following\nassumptions, some of which are hard requirements."),Object(o.b)("ul",null,Object(o.b)("li",{parentName:"ul"},"Each package must contain a ",Object(o.b)("inlineCode",{parentName:"li"},"package.json")," (of course)."),Object(o.b)("li",{parentName:"ul"},"Each package must have a source folder named ",Object(o.b)("inlineCode",{parentName:"li"},"src"),". Builds will output relative to this."),Object(o.b)("li",{parentName:"ul"},"Each package must have a source entry point, typically a ",Object(o.b)("inlineCode",{parentName:"li"},"src/index.ts")," file (or ",Object(o.b)("inlineCode",{parentName:"li"},"index.js")," if not\nusing TypeScript)."),Object(o.b)("li",{parentName:"ul"},"Each package may contain a ",Object(o.b)("inlineCode",{parentName:"li"},"tsconfig.json"),"."),Object(o.b)("li",{parentName:"ul"},"Each package should contain a ",Object(o.b)("inlineCode",{parentName:"li"},"LICENSE")," and ",Object(o.b)("inlineCode",{parentName:"li"},"README.md"),".")),Object(o.b)("p",null,"This would look something like the following."),Object(o.b)(i.a,{groupId:"package-structure",defaultValue:"solo",values:[{label:"Solorepo",value:"solo"},{label:"Monorepo",value:"mono"}],mdxType:"Tabs"},Object(o.b)(c.a,{value:"solo",mdxType:"TabItem"},Object(o.b)("pre",null,Object(o.b)("code",Object(a.a)({parentName:"pre"},{}),"/\n\u251c\u2500\u2500 src/\n\u251c\u2500\u2500 package.json\n\u251c\u2500\u2500 LICENSE\n\u2514\u2500\u2500 README.md\n"))),Object(o.b)(c.a,{value:"mono",mdxType:"TabItem"},Object(o.b)("pre",null,Object(o.b)("code",Object(a.a)({parentName:"pre"},{}),"/\n\u251c\u2500\u2500 packages/\n\u2502   \u251c\u2500\u2500 foo/\n\u2502   |   \u251c\u2500\u2500 src/\n\u2502   |   \u251c\u2500\u2500 package.json\n\u2502   |   \u251c\u2500\u2500 LICENSE\n\u2502   |   \u2514\u2500\u2500 README.md\n\u2502   \u251c\u2500\u2500 bar/\n\u2502   |   \u251c\u2500\u2500 src/\n\u2502   |   \u251c\u2500\u2500 package.json\n\u2502   |   \u251c\u2500\u2500 LICENSE\n\u2502   |   \u2514\u2500\u2500 README.md\n\u2502   \u2514\u2500\u2500 baz/\n\u2502       \u251c\u2500\u2500 src/\n\u2502       \u251c\u2500\u2500 package.json\n\u2502       \u251c\u2500\u2500 LICENSE\n\u2502       \u2514\u2500\u2500 README.md\n\u251c\u2500\u2500 lerna.json\n\u251c\u2500\u2500 package.json\n\u251c\u2500\u2500 LICENSE\n\u2514\u2500\u2500 README.md\n")))),Object(o.b)("h2",{id:"typescript-integration"},"TypeScript integration"),Object(o.b)("p",null,"Integrating with TypeScript can sometimes be tricky, and with Packemon, that is definitely the case.\nSince Packemon now handles the build process, TypeScript should be configured for type checking and\ndeclaration generation only."),Object(o.b)("h3",{id:"update-output-directories"},"Update output directories"),Object(o.b)("p",null,"Both the ",Object(o.b)("inlineCode",{parentName:"p"},"outDir")," and ",Object(o.b)("inlineCode",{parentName:"p"},"declarationDir")," settings should be updated to ",Object(o.b)("inlineCode",{parentName:"p"},"dts"),", and should ",Object(o.b)("em",{parentName:"p"},"not")," be set\nto ",Object(o.b)("inlineCode",{parentName:"p"},"lib"),", ",Object(o.b)("inlineCode",{parentName:"p"},"build"),", or some other variant. This is especially true if using project references."),Object(o.b)("pre",null,Object(o.b)("code",Object(a.a)({parentName:"pre"},{className:"language-json",metastring:'title="tsconfig.json"',title:'"tsconfig.json"'}),'{\n  "compilerOptions": {\n    "declarationDir": "dts",\n    "outDir": "dts"\n  }\n}\n')),Object(o.b)("h3",{id:"enable-emitting"},"Enable emitting"),Object(o.b)("p",null,"The ",Object(o.b)("inlineCode",{parentName:"p"},"noEmit")," setting should only be used on the command line (via an NPM script) and should not be\nconfigured explicitly. We require emitting of declarations."),Object(o.b)("pre",null,Object(o.b)("code",Object(a.a)({parentName:"pre"},{className:"language-json",metastring:'title="tsconfig.json"',title:'"tsconfig.json"'}),'{\n  "compilerOptions": {\n    "noEmit": false\n  }\n}\n')),Object(o.b)("h3",{id:"disable-json-resolving"},"Disable JSON resolving"),Object(o.b)("p",null,"The ",Object(o.b)("inlineCode",{parentName:"p"},"resolveJsonModule")," setting alters the output folder structure in such a way that it breaks the\nguarantees that Packemon needs for handling declarations."),Object(o.b)("pre",null,Object(o.b)("code",Object(a.a)({parentName:"pre"},{className:"language-json",metastring:'title="tsconfig.json"',title:'"tsconfig.json"'}),'{\n  "compilerOptions": {\n    "resolveJsonModule": false\n  }\n}\n')),Object(o.b)("blockquote",null,Object(o.b)("p",{parentName:"blockquote"},"If you really need to support this feature, please create an issue so that we can track it\nproperly.")),Object(o.b)("h3",{id:"supporting-project-references"},"Supporting project references"),Object(o.b)("p",null,"Alongside the requirements listed above, the ",Object(o.b)("inlineCode",{parentName:"p"},"tsconfig.json")," within each project reference package\nshould be updated to only emit declarations to ",Object(o.b)("inlineCode",{parentName:"p"},"dts"),", like so."),Object(o.b)("pre",null,Object(o.b)("code",Object(a.a)({parentName:"pre"},{className:"language-json",metastring:'title="tsconfig.json"',title:'"tsconfig.json"'}),'{\n  "compilerOptions": {\n    "declarationDir": "dts",\n    "outDir": "dts",\n    "rootDir": "src",\n    "emitDeclarationOnly": true\n  }\n}\n')))}b.isMDXComponent=!0},74:function(e,t,n){"use strict";function a(e){var t,n,r="";if("string"==typeof e||"number"==typeof e)r+=e;else if("object"==typeof e)if(Array.isArray(e))for(t=0;t<e.length;t++)e[t]&&(n=a(e[t]))&&(r&&(r+=" "),r+=n);else for(t in e)e[t]&&(r&&(r+=" "),r+=t);return r}t.a=function(){for(var e,t,n=0,r="";n<arguments.length;)(e=arguments[n++])&&(t=a(e))&&(r&&(r+=" "),r+=t);return r}},75:function(e,t,n){"use strict";n.d(t,"a",(function(){return p})),n.d(t,"b",(function(){return m}));var a=n(0),r=n.n(a);function o(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function i(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function c(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?i(Object(n),!0).forEach((function(t){o(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function l(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},o=Object.keys(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var s=r.a.createContext({}),u=function(e){var t=r.a.useContext(s),n=t;return e&&(n="function"==typeof e?e(t):c(c({},t),e)),n},p=function(e){var t=u(e.components);return r.a.createElement(s.Provider,{value:t},e.children)},b={inlineCode:"code",wrapper:function(e){var t=e.children;return r.a.createElement(r.a.Fragment,{},t)}},d=r.a.forwardRef((function(e,t){var n=e.components,a=e.mdxType,o=e.originalType,i=e.parentName,s=l(e,["components","mdxType","originalType","parentName"]),p=u(n),d=a,m=p["".concat(i,".").concat(d)]||p[d]||b[d]||o;return n?r.a.createElement(m,c(c({ref:t},s),{},{components:n})):r.a.createElement(m,c({ref:t},s))}));function m(e,t){var n=arguments,a=t&&t.mdxType;if("string"==typeof e||a){var o=n.length,i=new Array(o);i[0]=d;var c={};for(var l in t)hasOwnProperty.call(t,l)&&(c[l]=t[l]);c.originalType=e,c.mdxType="string"==typeof e?e:a,i[1]=c;for(var s=2;s<o;s++)i[s]=n[s];return r.a.createElement.apply(null,i)}return r.a.createElement.apply(null,n)}d.displayName="MDXCreateElement"},78:function(e,t,n){"use strict";var a=n(0);const r=Object(a.createContext)(void 0);t.a=r},79:function(e,t,n){"use strict";var a=n(0),r=n(78);t.a=function(){const e=Object(a.useContext)(r.a);if(null==e)throw new Error("`useUserPreferencesContext` is used outside of `Layout` Component.");return e}},86:function(e,t,n){"use strict";var a=n(0),r=n.n(a),o=n(79),i=n(74),c=n(47),l=n.n(c);const s=37,u=39;t.a=function(e){const{block:t,children:n,defaultValue:c,values:p,groupId:b}=e,{tabGroupChoices:d,setTabGroupChoices:m}=Object(o.a)(),[f,j]=Object(a.useState)(c),[g,O]=Object(a.useState)(!1);if(null!=b){const e=d[b];null!=e&&e!==f&&p.some((t=>t.value===e))&&j(e)}const h=e=>{j(e),null!=b&&m(b,e)},y=[],v=e=>{e.metaKey||e.altKey||e.ctrlKey||O(!0)},E=()=>{O(!1)};return Object(a.useEffect)((()=>{window.addEventListener("keydown",v),window.addEventListener("mousedown",E)}),[]),r.a.createElement("div",null,r.a.createElement("ul",{role:"tablist","aria-orientation":"horizontal",className:Object(i.a)("tabs",{"tabs--block":t})},p.map((({value:e,label:t})=>r.a.createElement("li",{role:"tab",tabIndex:0,"aria-selected":f===e,className:Object(i.a)("tabs__item",l.a.tabItem,{"tabs__item--active":f===e}),style:g?{}:{outline:"none"},key:e,ref:e=>y.push(e),onKeyDown:e=>{((e,t,n)=>{switch(n.keyCode){case u:((e,t)=>{const n=e.indexOf(t)+1;e[n]?e[n].focus():e[0].focus()})(e,t);break;case s:((e,t)=>{const n=e.indexOf(t)-1;e[n]?e[n].focus():e[e.length-1].focus()})(e,t)}})(y,e.target,e),v(e)},onFocus:()=>h(e),onClick:()=>{h(e),O(!1)},onPointerDown:()=>O(!1)},t)))),r.a.createElement("div",{role:"tabpanel",className:"margin-vert--md"},a.Children.toArray(n).filter((e=>e.props.value===f))[0]))}},87:function(e,t,n){"use strict";var a=n(0),r=n.n(a);t.a=function(e){return r.a.createElement("div",null,e.children)}}}]);